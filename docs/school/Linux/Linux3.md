---
slug: user
title: Linux用户权限管理
tags: [Linux, 权限, 用户]
---

# Linux 用户权限管理

## 第一部分：root 用户

### 1.1 概念

- 在 Linux 系统中，拥有最大权限的账户名为：root（超级管理员）
- 而在常规情况下，我们一直使用的账户是普通的用户：rose 用户
- root 用户拥有最大的系统操作权限，而普通用户在许多地方的权限是受限的
- 普通用户的权限，一般在其 HOME 目录内是不受限的，但一旦出了 HOME 目录，大多数地方，普通用户仅有只读和执行权限，无修改权限

### 1.2 su 和 exit 命令

ls 命令的作用是列出目录下的内容

```shell
su [-] [用户名]
exit #或者 ctrl+d
```

- `-` 符号是可选的，表示是否在切换用户后加载环境变量（后续讲解），建议带上
- 参数：用户名，表示要切换的用户，用户名也可以省略，省略表示切换到 root
- 切换用户后，可以通过 exit 命令退回上一个用户，也可以使用快捷键：`ctrl + d`

### 1.3 sudo 命令

ls 命令的作用是列出目录下的内容

```shell
#授权sudo
1. 切换root用户，执行visudo命令，打开etc/sudoers文件
2. 在文件最后添加下面这段话即可
rose ALL=(ALL) NOPASSWD:ALL
# NOPASSWD:ALL表示使用sudo命令，无需输入密码
```

- 在我们得知 root 密码的时候，可以通过 su 命令切换到 root 得到最大权限。
- 但是我们不建议长期使用 root 用户，避免带来系统损坏。
- 可以使用 sudo 命令，为普通的命令授权，临时以 root 身份执行。

## 第二部分：用户 用户组管理

### 2.1 用户组管理

```shell
#创建用户组
groupadd 用户组名
#删除用户组
groupdel 用户组名
# NOPASSWD:ALL表示使用sudo命令，无需输入密码
```

### 2.2 用户管理

```shell
#创建用户
useradd [-g -d] 用户名
#删除用户组
userdel [-r] 用户名
# 查看所属用户组
id [用户名]
# 修改所属用户组
usermod -aG 用户组 用户名
# 将指定用户加入指定用户组（但不会删掉在之前组的记录，会出现同个用户加两个组的情况）
```

- 添加时的选项：-g 指定用户的组，不指定-g，会创建同名组并自动加入，指定-g 需要组已经存在，如已存在同名组，必须使用-g
- 添加时的选项：-d 指定用户 HOME 路径，不指定，HOME 目录默认在：/home/用户名
- 删除时的选项：-r，删除用户的 HOME 目录，不使用-r，删除用户时，HOME 目录保留

### 2.3 getent 命令

使用`getent`命令，可以查看当前系统中有哪些用户

```shell
#查看关于用户的
getent passwd
#共有7份信息，分别是
# 用户名:    密码(x):   用户ID:   组ID:    描述信息(无用):    HOME目录:    执行终端(默认bash)



#查看关于用户组的
getent group
#共有3份信息，分别是
# 组名称:      组认证(显示为x):    组ID
```

## 第三部分：查看权限管控

通过 ls -l 获取到的数据，其中前三组数据是关于一下的

- 序号 1，表示文件、文件夹的权限控制信息，例如：d rwx r-x r-x
- 序号 2，表示文件、文件夹所属用户，例如：rose
- 序号 3，表示文件、文件夹所属用户组，例如：rose

其中第一个序列展示权限信息，例如：**drwxr-xr-x**

- 这是一个文件夹，首字母 d 表示
- 所属用户(右上角图序号 2)的权限是：有 r 有 w 有 x，rwx
- 所属用户组(右上角图序号 3)的权限是：有 r 无 w 有 x，r-x （-表示无此权限）
- 其它用户的权限是：有 r 无 w 有 x，r-x
- 其中：`r`表示 读 权限 `w` 表示 写 权限 `x` 表示 执行 权限（execute）

## 第四部分：修改文件权限信息

### 4.1 chomod 命令

chomod 命令的作用是**修改文件、文件夹的权限信息**

```shell
chmod -R 权限 文件或文件夹
chmod u=rwx,g=rwx,o=rx chmod.txt

```

- -R，对文件夹内的全部内容应用同样的操作

### 4.2 二进制权限表示

- r 记为 4，
- w 记为 2，
- x 记为 1，

```shell
chmod -R 二进制代码 文件或文件夹
chmod 751 chmod.txt
# 751所表示的权限为： rwx(7) r-x(5) --x(1)
```

## 第五部分：修改文件所属

### 4.1 chOWN 命令

chomod 命令的作用是**修改文件、文件夹的所属用户和用户组**

```shell
chown [-R] 1 [用户][:][用户组] 文件或文件夹

```

- -R，对文件夹内的全部内容应用同样的操作
- 选项，用户，修改所属用户
- 选项，用户组，修改所属用户组
- `:`用于分隔用户和用户组

```shell
chown root:itheima hello.txt
#将hello.txt所属用户修改为root，用户组修改为itheima


chown :it222 hello.txt
#将hello.txt所属用户组修改为it222


chown rose hello.txt
#将hello.txt所属用户修改为rose

```
