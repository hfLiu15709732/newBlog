---
slug: Golong_struct1
title: 7. ç»“æ„ä½“ï¼ˆ1ï¼‰ ğŸ—ï¸
tags: [Golong, "ç»“æ„ä½“"]
---

# Golang ä¸­çš„ç»“æ„ä½“ï¼ˆ1ï¼‰

## 1.ç±»å‹åˆ«åä¸è‡ªå®šä¹‰ç±»å‹

### 1.1 è‡ªå®šä¹‰ç±»å‹

:::info è‡ªå®šä¹‰ç±»å‹
åœ¨ Go è¯­è¨€ä¸­æœ‰ä¸€äº›åŸºæœ¬çš„æ•°æ®ç±»å‹,å¦‚ stringã€æ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”ç­‰æ•°æ®ç±»å‹ï¼Œ Go è¯­è¨€ä¸­å¯ä»¥ä½¿ç”¨ type å…³é”®å­—æ¥å®šä¹‰è‡ªå®šä¹‰ç±»å‹ã€‚

```go
//å°†MyIntå®šä¹‰ä¸ºintç±»å‹
type MyInt int
//é€šè¿‡typeå…³é”®å­—çš„å®šä¹‰ï¼ŒMyIntå°±æ˜¯ä¸€ç§æ–°çš„ç±»å‹ï¼Œå®ƒå…·æœ‰intçš„ç‰¹æ€§ã€‚
```

:::

### 1.2 ç±»å‹åˆ«å

:::note ç±»å‹åˆ«å

- é¦–å…ˆï¼šç±»å‹åˆ«åæ˜¯ Go1.9 ç‰ˆæœ¬æ·»åŠ çš„æ–°åŠŸèƒ½ã€‚
- `ç±»å‹åˆ«å`åªæ˜¯`ç±»å‹`çš„åˆ«åï¼Œæœ¬è´¨ä¸Š`ç±»å‹åˆ«å`å’Œ`ç±»å‹`æ˜¯åŒä¸€ä¸ªç±»å‹ã€‚å°±åƒä¸€ä¸ªå­©å­å°æ—¶å€™æœ‰å°åã€ä¹³åï¼Œä¸Šå­¦åç”¨å­¦åï¼Œè‹±è¯­è€å¸ˆåˆä¼šç»™ä»–èµ·è‹±æ–‡åï¼Œä½†è¿™äº›åå­—éƒ½æŒ‡çš„æ˜¯ä»–æœ¬äººã€‚

```go
type TypeAlias = Type

type byte = uint8
type rune = int32
```

:::

### 1.3 ç±»å‹åˆ«åä¸è‡ªå®šä¹‰ç±»å‹çš„ä¸åŒ

:::tip ç±»å‹åˆ«åä¸è‡ªå®šä¹‰ç±»å‹çš„ä¸åŒ

- åœ¨äºç±»å‹åˆ«ååªåœ¨ç¼–è¯‘å‰è¿›è¡ŒåŒºåˆ†ä½¿ç”¨ï¼Œç¼–è¯‘åï¼Œä»ç„¶æ˜¯ int ç­‰å…¶ä»–åŸºæœ¬ç±»å‹
- è€Œè‡ªå®šä¹‰åœ¨ç¼–è¯‘åæ˜¯å®æ‰“å®çš„æ–°ç±»å‹

```go title="å°æ¡ˆä¾‹å±•ç¤º"
//ç±»å‹å®šä¹‰
type NewInt int

//ç±»å‹åˆ«å
type MyInt = int

func main() {
	var a NewInt
	var b MyInt

	fmt.Printf("type of a:%T\n", a) //type of a:main.NewInt
	fmt.Printf("type of b:%T\n", b) //type of b:int
}
```

:::

## 2.è®¤è¯†ç»“æ„ä½“

### 2.1 ç»“æ„ä½“å®šä¹‰

### 2.2 ç»“æ„ä½“å®ä¾‹åŒ–

:::info æ³¨æ„
åªæœ‰å½“ç»“æ„ä½“å®ä¾‹åŒ–æ—¶ï¼Œæ‰ä¼šçœŸæ­£åœ°åˆ†é…å†…å­˜ã€‚ä¹Ÿå°±æ˜¯å¿…é¡»å®ä¾‹åŒ–åæ‰èƒ½ä½¿ç”¨ç»“æ„ä½“çš„å­—æ®µã€‚

ç»“æ„ä½“æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åƒå£°æ˜å†…ç½®ç±»å‹ä¸€æ ·ä½¿ç”¨ var å…³é”®å­—å£°æ˜ç»“æ„ä½“ç±»å‹ã€‚

```go
var ç»“æ„ä½“å®ä¾‹ ç»“æ„ä½“ç±»å‹
```

:::

#### 2.2.1 åŸºæœ¬å®ä¾‹åŒ–

```go
type person struct {
	name string
	city string
	age  int8
}

func main() {
	var p1 person
	p1.name = "æ²™æ²³å¨œæ‰"
	p1.city = "åŒ—äº¬"
	p1.age = 18
	fmt.Printf("p1=%v\n", p1)  //p1={æ²™æ²³å¨œæ‰ åŒ—äº¬ 18}
	fmt.Printf("p1=%#v\n", p1) //p1=main.person{name:"æ²™æ²³å¨œæ‰", city:"åŒ—äº¬", age:18}
}
```

#### 2.2.2 new()å®ä¾‹åŒ–

```go
var p2 = new(person)//è¿”å›çš„p2æ˜¯ç»“æ„ä½“æŒ‡é’ˆ
fmt.Printf("%T\n", p2)     //*main.person
fmt.Printf("p2=%#v\n", p2) //p2=&main.person{name:"", city:"", age:0}
```

#### 2.2.3 å–åœ°å€å®ä¾‹åŒ–

```go
p3 := &person{}
fmt.Printf("%T\n", p3)     //*main.person
fmt.Printf("p3=%#v\n", p3) //p3=&main.person{name:"", city:"", age:0}
p3.name = "ä¸ƒç±³"
p3.age = 30
p3.city = "æˆéƒ½"
fmt.Printf("p3=%#v\n", p3) //p3=&main.person{name:"ä¸ƒç±³", city:"æˆéƒ½", age:30}
```

### 2.3 ç»“æ„ä½“åˆå§‹åŒ–

:::info æ³¨æ„
æ²¡æœ‰åˆå§‹åŒ–çš„ç»“æ„ä½“(ä»…è¿›è¡Œäº†å®ä¾‹åŒ–çš„ç»“æ„ä½“)ï¼Œå…¶æˆå‘˜å˜é‡éƒ½æ˜¯å¯¹åº”å…¶ç±»å‹çš„é›¶å€¼ã€‚

```go
type person struct {
	name string
	city string
	age  int8
}

func main() {
	var p4 person
	fmt.Printf("p4=%#v\n", p4) //p4=main.person{name:"", city:"", age:0}
}
```

:::

#### 2.3.1 é”®å€¼å¯¹åˆå§‹åŒ–

```go
//ä¸‰ç§ç±»å‹çš„å°æ¡ˆä¾‹

p5 := person{
	name: "å°ç‹å­",
	city: "åŒ—äº¬",
	age:  18,
}
fmt.Printf("p5=%#v\n", p5) //p5=main.person{name:"å°ç‹å­", city:"åŒ—äº¬", age:18}


p6 := &person{
	name: "å°ç‹å­",
	city: "åŒ—äº¬",
	age:  18,
}
fmt.Printf("p6=%#v\n", p6) //p6=&main.person{name:"å°ç‹å­", city:"åŒ—äº¬", age:18}


p7 := &person{
	city: "åŒ—äº¬",
}
fmt.Printf("p7=%#v\n", p7) //p7=&main.person{name:"", city:"åŒ—äº¬", age:0}
```

#### 2.3.2 å€¼åˆ—è¡¨å®ä¾‹åŒ–

```go
p8 := &person{
	"æ²™æ²³å¨œæ‰",
	"åŒ—äº¬",
	28,
}
fmt.Printf("p8=%#v\n", p8) //p8=&main.person{name:"æ²™æ²³å¨œæ‰", city:"åŒ—äº¬", age:28}



/*
ä½¿ç”¨è¿™ç§æ ¼å¼åˆå§‹åŒ–æ—¶ï¼Œéœ€è¦æ³¨æ„ï¼š

    1.å¿…é¡»åˆå§‹åŒ–ç»“æ„ä½“çš„æ‰€æœ‰å­—æ®µã€‚
    2.åˆå§‹å€¼çš„å¡«å……é¡ºåºå¿…é¡»ä¸å­—æ®µåœ¨ç»“æ„ä½“ä¸­çš„å£°æ˜é¡ºåºä¸€è‡´ã€‚
    3.è¯¥æ–¹å¼ä¸èƒ½å’Œé”®å€¼åˆå§‹åŒ–æ–¹å¼æ··ç”¨ã€‚
*/



```

### 2.4 ç»“æ„ä½“å†…å­˜å¸ƒå±€

:::info
**ç»“æ„ä½“å ç”¨ä¸€å—è¿ç»­çš„å†…å­˜,ä¸‹é¢æ˜¯ä¸€ä¸ªæµ‹è¯•å°æ¡ˆä¾‹**

```go
type test struct {
	a int8
	b int8
	c int8
	d int8
}
n := test{
	1, 2, 3, 4,
}
fmt.Printf("%p\n", &n.a)//0xc0000a0060
fmt.Printf("%p\n", &n.b)//0xc0000a0061
fmt.Printf("%p\n", &n.c)//0xc0000a0062
fmt.Printf("%p\n", &n.d)//0xc0000a0063

```

:::

### 2.5 ç©ºç»“æ„ä½“

:::info
ç©ºç»“æ„ä½“æ˜¯ä¸å ç”¨ç©ºé—´çš„ã€‚

```go
var v struct{}
fmt.Println(unsafe.Sizeof(v))  // 0

```

:::

### 2.6 ç»“æ„ä½“æ„é€ å‡½æ•°

:::info
Go è¯­è¨€çš„ç»“æ„ä½“æ²¡æœ‰æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°ã€‚ ä¾‹å¦‚ï¼Œä¸‹æ–¹çš„ä»£ç å°±å®ç°äº†ä¸€ä¸ª person çš„æ„é€ å‡½æ•°ã€‚ å› ä¸º struct æ˜¯å€¼ç±»å‹ï¼Œå¦‚æœç»“æ„ä½“æ¯”è¾ƒå¤æ‚çš„è¯ï¼Œå€¼æ‹·è´æ€§èƒ½å¼€é”€ä¼šæ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥è¯¥æ„é€ å‡½æ•°è¿”å›çš„æ˜¯ç»“æ„ä½“æŒ‡é’ˆç±»å‹ã€‚

```go
var v struct{}
func newPerson(name, city string, age int8) *person {
	return &person{
		name: name,
		city: city,
		age:  age,
	}
}
```

:::

## 3.æ–¹æ³•ä¸æ¥å—è€…

:::info ç®€ä»‹
Go è¯­è¨€ä¸­çš„æ–¹æ³•ï¼ˆMethodï¼‰æ˜¯ä¸€ç§ä½œç”¨äºç‰¹å®šç±»å‹å˜é‡çš„å‡½æ•°ã€‚è¿™ç§ç‰¹å®šç±»å‹å˜é‡å«åšæ¥æ”¶è€…ï¼ˆReceiverï¼‰ã€‚æ¥æ”¶è€…çš„æ¦‚å¿µå°±ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„ this æˆ–è€… selfã€‚

```go
//ç»“æ„å¦‚ä¸‹ï¼š
func (æ¥æ”¶è€…å˜é‡ æ¥æ”¶è€…ç±»å‹) æ–¹æ³•å(å‚æ•°åˆ—è¡¨) (è¿”å›å‚æ•°) {
    å‡½æ•°ä½“
}
```

:::

### 3.1 å€¼ç±»å‹æ¥å—è€…

```go

// SetAge2 è®¾ç½®pçš„å¹´é¾„
// ä½¿ç”¨å€¼æ¥æ”¶è€…
func (p Person) SetAge2(newAge int8) {
	p.age = newAge//å®é™…æ— æ³•ä¿®æ”¹è¯¥æ•°æ®ï¼ˆä¼ æ¥çš„çŸ¥åªæ˜¯æ•°æ®å‰¯æœ¬ï¼‰
}

func main() {
	p1 := NewPerson("å°ç‹å­", 25)
	p1.Dream()
	fmt.Println(p1.age) // 25
	p1.SetAge2(30) // (*p1).SetAge2(30)
	fmt.Println(p1.age) // 25
}
```

### 3.2 æŒ‡é’ˆç±»å‹æ¥å—è€…

```go

// SetAge è®¾ç½®pçš„å¹´é¾„
// ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…
func (p *Person) SetAge(newAge int8) {
	p.age = newAge//å¯ä»¥å®ç°æ•°æ®çš„ä¿®æ”¹ï¼Œå› ä¸ºæ˜¯æŒ‡é’ˆ
}


func main() {
	p1 := NewPerson("å°ç‹å­", 25)
	fmt.Println(p1.age) // 25
	p1.SetAge(30)
	fmt.Println(p1.age) // 30
}
```

### 3.3 ä½¿ç”¨åœºæ™¯

1. éœ€è¦ä¿®æ”¹æ¥æ”¶è€…ä¸­çš„å€¼
2. æ¥æ”¶è€…æ˜¯æ‹·è´ä»£ä»·æ¯”è¾ƒå¤§çš„å¤§å¯¹è±¡
3. ä¿è¯ä¸€è‡´æ€§ï¼Œå¦‚æœæœ‰æŸä¸ªæ–¹æ³•ä½¿ç”¨äº†æŒ‡é’ˆæ¥æ”¶è€…ï¼Œé‚£ä¹ˆå…¶ä»–çš„æ–¹æ³•ä¹Ÿåº”è¯¥ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…ã€‚
4. **ä¸€èˆ¬å°±ç›´æ¥ä½¿ç”¨æŒ‡é’ˆæ¥å—è€…å°±å®Œäº‹äº†**
